# graduate_work
ВКР МАИ

# Проблема 

Популярные системы отрисовки архитектурных диаграмм (structurizr) используют  универсальные раскладки графов. Из за их универсальности иногда страдает  визуальная понятность и затрудняется понимания системы.

# Цель работы

Улучшить визуализацию сложных архитектурых диаграмм в нотации С4.

# Гипотеза

Использовать для представления диаграммы не только одну раскладку, а сразу несколько. А дальше из набора изображений выбрать то, которое является самым удачным для понимания.

# Постановка задачи

Создать веб сервис, который принимает описание архитектурной диаграммы в формате С4 structurizr/json. Сервис должен возвращать изображение, которое оказалось самым лучшим для конкретного представления.

# Как это работает

Кратко опишу как работает сервис:

1) получение structurizr/json и название view, для которого необходимо вернуть изображение
2) создание .dot файлов для всех view с помощью structurzr export
3) нахождение целевого .dot файла
4) насыщение .dot файла для улучшения визуализации (*например, запрет наложения объектов*)
5) создание .svg изображений c помощью **graphfiz**, используя раскладки: dot, fdp, sfdp, neato, twopi, circo
6) выбор лучшего изображения с помощью модели CLIP от openai
7) возврат лучшего изображения в формате svg 

# Запуск

Для запуска необходим docker

```bash
make build # cборка docker образа
make run # запускает контейнер
```

# Как использовать

Сервис имеет один обработчик: `/api/best/{target_view}`, где {target_view} - это название представления, для которого мы хотим получить изображение

Для локального запуска:

```bash
curl -v -X POST http://0.0.0.0:8000/api/best/all_containers -H "Content-Type: application/json" -d @examples/input.json -o result.svg
```

Так же сейчас приложение развернуто в облаке по ip `95.181.162.65`. 
Воспользоваться можно так:
```bash
curl -v -X POST http://95.181.162.65:8000/api/best/all_containers -H "Content-Type: application/json" -d @examples/input.json -o result.svg
```



